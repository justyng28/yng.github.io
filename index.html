<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bầu trời sao lãng mạn</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      overflow: hidden;
      height: 100vh;
      width: 100vw;
      font-family: 'Segoe UI', sans-serif;
    }

    #world {
      position: absolute;
      width: 100%;
      height: 100%;
      perspective: 1500px;
      overflow: hidden;
      top: 0;
      left: 0;
    }

    .text {
      position: absolute;
      color: white;
      white-space: nowrap;
      user-select: none;
      text-shadow:
        0 0 5px #ff69b4,
        0 0 10px #ff1493,
        0 0 20px #ff1493,
        0 0 30px #c71585;
      pointer-events: none;
    }

    .star, .star-special, .blur {
      position: absolute;
      pointer-events: none;
      user-select: none;
    }

    .star {
      background: white;
      border-radius: 50%;
      opacity: 0.8;
    }

    .star-special span {
      text-shadow: 0 0 6px gold;
    }

    .blink {
      animation: blink 1.5s infinite alternate;
    }

    @keyframes blink {
      0% { opacity: 0.2; }
      100% { opacity: 1; }
    }

    .blur {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      filter: blur(4px);
      opacity: 0.6;
    }
  </style>
</head>
<body>
  <div id="world"></div>

  <script>
    const nightsky = ["#280F36", "#632B6C", "#BE6590", "#FFC1A0", "#FE9C7F"];
    const world = document.getElementById('world');
    const texts = [];
    const starParticles = [];

    const words = [
      "Anh yêu em", "Em là cả thế giới của anh", "Anh muốn bên em mãi mãi",
      "Tình yêu anh dành cho em không bao giờ phai nhạt", "Em là thiên thần của anh",
      "Anh nhớ em nhiều lắm", "Anh muốn nắm tay em suốt đời",
      "Anh hạnh phúc vì có em trong đời", "Tình yêu này là mãi mãi",
      "Anh yêu em, mãi mãi không đổi thay", "Anh nguyện làm mọi thứ vì em",
      "Tình yêu của anh dành cho em là vô biên"
    ];

    const COUNT_TEXT = 700;       // Giảm số lượng chữ bay
    const STAR_COUNT = 10;       // Giảm số lượng sao thường
    const BLUR_COUNT = 5;        // Sao mờ
    const SPECIAL_COUNT = 5;     // Sao đặc biệt
    const RADIUS = 1800;

    function randomRange(min, max) {
      return Math.random() * (max - min) + min;
    }

    function randomPointInSphere(radius) {
      const u = Math.random();
      const v = Math.random();
      const theta = 2 * Math.PI * u;
      const phi = Math.acos(2 * v - 1);
      const r = Math.cbrt(Math.random()) * radius;
      return {
        x: r * Math.sin(phi) * Math.cos(theta),
        y: r * Math.sin(phi) * Math.sin(theta),
        z: r * Math.cos(phi)
      };
    }

    for (let i = 0; i < COUNT_TEXT; i++) {
      const el = document.createElement('div');
      el.className = 'text';
      el.innerText = words[Math.floor(Math.random() * words.length)];
      el.style.fontSize = randomRange(14, 22) + "px";
      world.appendChild(el);
      const pos = randomPointInSphere(RADIUS);
      texts.push({ el, x: pos.x, y: pos.y, z: pos.z, speed: randomRange(0.4, 1) });
    }

    for (let i = 0; i < STAR_COUNT; i++) {
      const el = document.createElement('div');
      el.className = 'star';
      if (i % 3 === 0) el.classList.add('blink');
      el.style.width = el.style.height = randomRange(1, 3) + 'px';
      world.appendChild(el);
      const pos = randomPointInSphere(RADIUS);
      starParticles.push({ el, x: pos.x, y: pos.y, z: pos.z, speed: randomRange(0.1, 0.3) });
    }

    for (let i = 0; i < BLUR_COUNT; i++) {
      const el = document.createElement('div');
      el.className = 'blur';
      el.style.backgroundColor = nightsky[Math.floor(Math.random() * nightsky.length)];
      world.appendChild(el);
      const pos = randomPointInSphere(RADIUS);
      starParticles.push({ el, x: pos.x, y: pos.y, z: pos.z, speed: 0 });
    }

    for (let i = 0; i < SPECIAL_COUNT; i++) {
      const el = document.createElement('div');
      el.className = 'star-special';
      el.innerHTML = '<span style="color: gold; font-size: 10px;">★</span>';
      el.style.filter = "drop-shadow(0 0 6px white)";
      world.appendChild(el);
      const pos = randomPointInSphere(RADIUS);
      starParticles.push({ el, x: pos.x, y: pos.y, z: pos.z, speed: randomRange(0.1, 0.3) });
    }

    let rotateX = 15, rotateY = 0;
    let isDragging = false, lastX = 0, lastY = 0;

    document.addEventListener('mousedown', e => {
      isDragging = true;
      lastX = e.clientX;
      lastY = e.clientY;
    });

    document.addEventListener('mouseup', () => isDragging = false);
    document.addEventListener('mousemove', e => {
      if (isDragging) {
        const dx = e.clientX - lastX;
        const dy = e.clientY - lastY;
        lastX = e.clientX;
        lastY = e.clientY;
        rotateY += dx * 0.3;
        rotateX -= dy * 0.3;
        rotateX = Math.min(Math.max(rotateX, -90), 90);
      }
    });

    document.addEventListener('touchstart', e => {
      if (e.touches.length === 1) {
        isDragging = true;
        lastX = e.touches[0].clientX;
        lastY = e.touches[0].clientY;
      }
    }, { passive: false });

    document.addEventListener('touchend', () => isDragging = false, { passive: false });
    document.addEventListener('touchmove', e => {
      if (isDragging && e.touches.length === 1) {
        const dx = e.touches[0].clientX - lastX;
        const dy = e.touches[0].clientY - lastY;
        lastX = e.touches[0].clientX;
        lastY = e.touches[0].clientY;
        rotateY += dx * 0.3;
        rotateX -= dy * 0.3;
        rotateX = Math.min(Math.max(rotateX, -90), 90);
      }
    }, { passive: false });

    function toRad(deg) {
      return deg * Math.PI / 180;
    }

    function renderElement(obj) {
      const perspective = 1500;
      const radX = toRad(rotateX);
      const radY = toRad(rotateY);
      const cosX = Math.cos(radX), sinX = Math.sin(radX);
      const cosY = Math.cos(radY), sinY = Math.sin(radY);

      obj.y += obj.speed;
      if (obj.y > RADIUS) obj.y = -RADIUS;

      let x = obj.x, y = obj.y, z = obj.z;
      let xr = x * cosY - z * sinY;
      let zr = x * sinY + z * cosY;
      let yr = y * cosX - zr * sinX;
      zr = y * sinX + zr * cosX;

      const scale = perspective / (perspective + zr);
      const screenX = window.innerWidth / 2 + xr * scale;
      const screenY = window.innerHeight / 2 + yr * scale;

      obj.el.style.transform = `translate(-50%, -50%) translate3d(${screenX}px, ${screenY}px, 0) scale(${scale.toFixed(3)})`;
      obj.el.style.opacity = (zr > -perspective * 0.3) ? 1 : 0;
    }

    function animate() {
      texts.forEach(t => renderElement(t));
      starParticles.forEach(s => renderElement(s));
      requestAnimationFrame(animate);
    }

    animate();
    window.addEventListener('resize', () => location.reload());
  </script>
</body>
</html>
